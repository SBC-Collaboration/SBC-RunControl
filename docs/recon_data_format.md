# Data Formats
This documentation contains information for the data structures of different saved files by the RLAr10Ana analysis module.

## Version
The `version.txt` file saves the [version of LAr10Ana](https://github.com/SBC-Collaboration/LAr10Ana/releases) repository that's run to produce the outputs. Between manually added tags (like `v0.0.1`), it displays the number of commits from last tag, and the hash of latest commit. 

## Event Analysis
This module (`EventAnalysis.py`) simply copies the information from `event_info.sbc` in the raw data folder, and saves to `event.sbc` in the output folder.
- **run_id** (`string100`): Run ID generated by run control software, like "20240101_0". Run_ID and event_ID combined is a unique key for the event.
- **event_id** (`uint32`): Integer event ID starting from 0 in the run. 
- **ev_exit_code** (`uint16`): Exit code when event stops. 0 means success, and other numbers mean some kind of error. Null value mean the event quitted unexpectedly. 
- **ev_livetime** (`uint64`): Run control livetime for this event.
- **cum_livetime** (`uint64`): Cumulative livetime of the run at the end of the event.
- **pset_lo** (`float`, bara): Lower pressure set point for this event.
- **pset_hi** (`float`, bara): Higher pressure set point.
- **pset_ramp1** (`float`, bar/s): Rate of ramp from compressed state to `pset_hi`.
- **pset_ramp_down** (`flat`, bar/s): Rate of ramp from `pset_hi` to `pset_lo`.
- **pset_ramp_up** (`flat`, bar/s): Rate of ramp from `pset_lo` to `pset_hi`.
- **pset_period** (`float`): Period of oscillation between higher and lower set points. In units of seconds.
- **start_time** (`double`): Timestamp of the event start.
- **end_time** (`double`): Timestamp of the event stop.
- **trigger_source** (`string100`): Name of trigger's first fault.
- **runid**: Run ID of this row. (Added by EventDealer)
- **ev**: Event ID of this row. (Added by EventDealer)

## Exposure Analysis
This module (`ExposureAnalysis.py`) looks at pressure transducers PT2121 (CF4 cryo) and PT1101 (Ar cryo) in `slow_daq.sbc`. For each PT, it counts the time the system spends in each pressure bin (0-10 bar in 0.05 bar interval). Then it only counts the portion of the pressure curve that's below the most populated bin, which is counted as "expanded"
- **PT2121_pressure**: Average pressure when expanded
- **PT2121_livetime**: Time spent expanded
- **PT1101_pressure**: Average pressure when expanded
- **PT1101_livetime**: Time spent expanded
- **runid**: Run ID of this row. (Added by EventDealer)
- **ev**: Event ID of this row. (Added by EventDealer)

## Scintillation Analysis
This module (`SiPMPulses.py`) loads the scintillation file for each event, and performs basic analysis on the waveform of each CAEN trigger. Then the triggers of all events are concatenated together in this file. All analysis are done per CAEN trigger per channel. If no hit is identified, it will be saved as `np.nan`.
- **baseline**
- **rms**
- **hit_t0**
- **hit_tf**
- **hit_area**
- **wvf_area**
- **second_pulse**
- **max_avg_fft_freq**
- **runid**: Run ID of this row. (Added by EventDealer)
- **ev**: Event ID of this row. (Added by EventDealer)

## Scintillation Rate Analysis
This module (`ScintRate.py`) follows the same structure as the scintillation module. For each CAEN trigger, is sums the number of channels that are hit, and gives a 32-bit number that tells which channels are hit.
- **n_hits**: Number of hit SiPMs in this CAEN trigger.
- **hits_mask**: 32-bit mask of channels that are hit.
- **runid**: Run ID of this row. (Added by EventDealer)
- **ev**: Event ID of this row. (Added by EventDealer)
